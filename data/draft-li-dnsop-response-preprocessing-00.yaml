---
id: draftlidnsopresponsepreprocessing00
type: standard
schema_version: v1.4.1
title:
- language: en
  script: Latn
  content: 'DNS Response Pre-processing Security Guidelines: Awaiting Valid Responses'
source:
- type: src
  content: https://datatracker.ietf.org/doc/html/draft-li-dnsop-response-preprocessing-00
docidentifier:
- content: draft-li-dnsop-response-preprocessing
  type: Internet-Draft
- content: draft-li-dnsop-response-preprocessing-00
  type: Internet-Draft
  primary: true
docnumber: I-D.li-dnsop-response-preprocessing
date:
- type: published
  at: '2025-07-19'
contributor:
- role:
  - type: author
  person:
    name:
      forename:
      - language: en
        script: Latn
        content: Xiang
      - language: en
        script: Latn
        initial: X
      formatted_initials:
        language: en
        content: X.
      surname:
        language: en
        content: Li
      completename:
        language: en
        content: Xiang Li
    affiliation:
    - organization:
        name:
        - language: en
          content: Nankai University
- role:
  - type: author
  person:
    name:
      forename:
      - language: en
        script: Latn
        content: Yuqi
      - language: en
        script: Latn
        initial: "Y"
      formatted_initials:
        language: en
        content: Y.
      surname:
        language: en
        content: Qiu
      completename:
        language: en
        content: Yuqi Qiu
    affiliation:
    - organization:
        name:
        - language: en
          content: Nankai University
version:
- draft: '00'
language:
- en
script:
- Latn
abstract:
- language: en
  script: Latn
  content: "   The security and robustness of the Domain Name System (DNS)\n   significantly
    depend on how resolvers handle received responses.\n   Current DNS specifications
    lack exhaustive and consistent guidance on\n   response pre-processing, particularly
    for malformed or unexpected\n   packets.  This specification gap has led to implementation\n
    \  divergences and has been shown to introduce security vulnerabilities\n   such
    as DNS cache poisoning, Denial of Service (DoS), and resource\n   exhaustion,
    as detailed in the TUDOOR attack research.\n\n   This document aims to clarify
    and standardize the behavior of DNS\n   resolvers when receiving and initially
    processing responses from\n   upstream servers.  The core proposal is the \"Awaiting
    Valid\n   Responses\" mechanism, which mandates that a resolver, after issuing
    a\n   query, MUST maintain a defined waiting period to receive a well-\n   formed,
    relevant, and validated response.  During this period, non-\n   compliant incoming
    packets should be discarded, and the resolver\n   should continue to wait until
    a valid response is received or the\n   query times out.  This document provides
    guidance for DNS\n   implementers to mitigate security risks arising from flaws
    in\n   response pre-processing logic.\n\n\t "
relation:
- type: updatedBy
  bibitem:
    formattedref: draft-li-dnsop-response-preprocessing-01
    source:
    - type: src
      content: https://datatracker.ietf.org/doc/html/draft-li-dnsop-response-preprocessing-01
    docidentifier:
    - content: draft-li-dnsop-response-preprocessing-01
      type: Internet-Draft
      primary: true
series:
- type: main
  title:
  - language: en
    script: Latn
    content: Internet-Draft
  number: draft-li-dnsop-response-preprocessing-00
ext:
  schema_version: v1.0.1
  doctype:
    content: internet-draft
  flavor: ietf
