---
id: draftlidnsopecsaggregationfix00
type: standard
schema_version: v1.4.1
title:
- language: en
  script: Latn
  content: Strengthening DNS Query Aggregation against ECS-based Attacks
source:
- type: src
  content: https://datatracker.ietf.org/doc/html/draft-li-dnsop-ecs-aggregation-fix-00
docidentifier:
- content: draft-li-dnsop-ecs-aggregation-fix
  type: Internet-Draft
- content: draft-li-dnsop-ecs-aggregation-fix-00
  type: Internet-Draft
  primary: true
docnumber: I-D.li-dnsop-ecs-aggregation-fix
date:
- type: published
  at: '2025-10-15'
contributor:
- role:
  - type: author
  person:
    name:
      forename:
      - language: en
        script: Latn
        content: Xiang
      - language: en
        script: Latn
        initial: X
      formatted_initials:
        language: en
        content: X.
      surname:
        language: en
        content: Li
      completename:
        language: en
        content: Xiang Li
    affiliation:
    - organization:
        name:
        - language: en
          content: Nankai University
- role:
  - type: author
  person:
    name:
      forename:
      - language: en
        script: Latn
        content: Yuqi
      - language: en
        script: Latn
        initial: "Y"
      formatted_initials:
        language: en
        content: Y.
      surname:
        language: en
        content: Qiu
      completename:
        language: en
        content: Yuqi Qiu
    affiliation:
    - organization:
        name:
        - language: en
          content: Nankai University
version:
- draft: '00'
language:
- en
script:
- Latn
abstract:
- language: en
  script: Latn
  content: "   The DNS query aggregation mechanism is a critical defense against DNS\n
    \  cache poisoning attacks that exploit the \"Birthday Paradox\".\n   However,
    recent research has revealed that flawed implementations of\n   the EDNS Client
    Subnet (ECS) option, as specified in RFC 7871, can be\n   exploited to bypass
    this defense.  This allows attackers to force a\n   resolver to issue multiple
    simultaneous queries for the same domain\n   name by crafting queries with different
    ECS options.  This\n   vulnerability revives the classic DNS Birthday Attack,
    posing a\n   significant threat to DNS resolvers and the clients they serve.\n\n
    \  This document specifies a stricter and more coherent processing model\n   for
    the ECS option in DNS resolvers.  It introduces a mechanism for\n   resolvers
    to track the ECS support state of authoritative nameservers\n   and mandates query
    aggregation for zones determined to not support\n   ECS.  These changes are designed
    to close the identified\n   vulnerability and restore the effectiveness of query
    aggregation as a\n   defense mechanism.\n\n\t "
series:
- type: main
  title:
  - language: en
    script: Latn
    content: Internet-Draft
  number: draft-li-dnsop-ecs-aggregation-fix-00
ext:
  schema_version: v1.0.1
  doctype:
    content: internet-draft
  flavor: ietf
