---
schema-version: v1.2.9
id: draft-li-dnsop-ecs-aggregation-fix
title:
- content: Strengthening DNS Query Aggregation against ECS-based Attacks
  language:
  - en
  script:
  - Latn
  format: text/plain
docid:
- id: draft-li-dnsop-ecs-aggregation-fix
  type: Internet-Draft
  primary: true
abstract:
- content: <p>The DNS query aggregation mechanism is a critical defense against DNS
    cache poisoning attacks that exploit the "Birthday Paradox". However, recent research
    has revealed that flawed implementations of the EDNS Client Subnet (ECS) option,
    as specified in RFC 7871, can be exploited to bypass this defense. This allows
    attackers to force a resolver to issue multiple simultaneous queries for the same
    domain name by crafting queries with different ECS options. This vulnerability
    revives the classic DNS Birthday Attack, posing a significant threat to DNS resolvers
    and the clients they serve. This document specifies a stricter and more coherent
    processing model for the ECS option in DNS resolvers. It introduces a mechanism
    for resolvers to track the ECS support state of authoritative nameservers and
    mandates query aggregation for zones determined to not support ECS. These changes
    are designed to close the identified vulnerability and restore the effectiveness
    of query aggregation as a defense mechanism.</p>
  language:
  - en
  script:
  - Latn
  format: text/html
relation:
- type: includes
  bibitem:
    id: draft-li-dnsop-ecs-aggregation-fix-00
    docid:
    - id: draft-li-dnsop-ecs-aggregation-fix-00
      type: Internet-Draft
      primary: true
    formattedref:
      content: draft-li-dnsop-ecs-aggregation-fix-00
      format: text/plain
